<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OFFON</title>
    <link rel="icon" type="image/png" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACMAAAAeCAYAAACmPacqAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAFwmlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGF
    ja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDIgNzkuMTYwOTI0LCAyMDE3LzA3
    LzEzLTAxOjA2OjM5ICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6L
    y9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIgeG1sbnM6cGhvdG9zaG9wPSJodHRwOi8vbnMuYWRvYmUuY29tL3Bob3Rvc2hvcC8xLjAvIiB4bWxuczp4bXBNTT0iaH
    R0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgKFdpbmR
    vd3MpIiB4bXA6Q3JlYXRlRGF0ZT0iMjAyNS0wNS0wNlQwODo0ODozNCswMjowMCIgeG1wOk1vZGlmeURhdGU9IjIwMjUtMDUtMDZUMDg6NDk6NTErMDI6MDAiIHhtcDpNZXRhZGF0YURhdGU9IjIwMjUtMDUtMDZUMDg6NDk6NTErMDI6MDAi
    IGRjOmZvcm1hdD0iaW1hZ2UvcG5nIiBwaG90b3Nob3A6Q29sb3JNb2RlPSIzIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjIwYTg4ZDYxLWI4M2UtZTc0ZS1iOTg5LTFiN2M5OWM4MzhlYyIgeG1wTU06RG9jdW1lbnRJRD0iYWRvYmU6Z
    G9jaWQ6cGhvdG9zaG9wOjgwZWRmZGE2LTA0MDQtZDM0MC1iZGExLTM2NDc1ZjkyZmRhNiIgeG1wTU06T3JpZ2luYWxEb2N1bWVudElEPSJ4bXAuZGlkOjVlZDEzOWZjLTViNTUtOGM0YS04YWJhLTNjMTUyNmVjYTk3ZiI+IDx4bXBNTTpIaX
    N0b3J5PiA8cmRmOlNlcT4gPHJkZjpsaSBzdEV2dDphY3Rpb249ImNyZWF0ZWQiIHN0RXZ0Omluc3RhbmNlSUQ9InhtcC5paWQ6NWVkMTM5ZmMtNWI1NS04YzRhLThhYmEtM2MxNTI2ZWNhOTdmIiBzdEV2dDp3aGVuPSIyMDI1LTA1LTA2VDA
    4OjQ4OjM0KzAyOjAwIiBzdEV2dDpzb2Z0d2FyZUFnZW50PSJBZG9iZSBQaG90b3Nob3AgQ0MgKFdpbmRvd3MpIi8+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJzYXZlZCIgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDoyMGE4OGQ2MS1iODNl
    LWU3NGUtYjk4OS0xYjdjOTljODM4ZWMiIHN0RXZ0OndoZW49IjIwMjUtMDUtMDZUMDg6NDk6NTErMDI6MDAiIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkFkb2JlIFBob3Rvc2hvcCBDQyAoV2luZG93cykiIHN0RXZ0OmNoYW5nZWQ9Ii8iLz4gP
    C9yZGY6U2VxPiA8L3htcE1NOkhpc3Rvcnk+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+OTRv3QAAAI1JREFUWIXtl0EOgCAMBBfjH/Rz+rj6ufoKPBgCInttOXQSEuiFSQ
    uHTRDN6MjHlvqaBSsA4NxrRdTDA0CR6UjX/euWBUOZT6esEMVifytn3BnLd/OZwvub6mrPxvupxhQyjJBhhAwjZBghwwgZRsgwQoaRIJpdo0q5W3SidIDJxuSfDhqGMr5Z2zFftzyHUU2u9rdT5wAAAABJRU5ErkJggg==">
    <style>
        body {
            text-align: center;
            padding: 50px;
            font-family: Arial, sans-serif;
            background-color: #474646;
        }
        h1 {
            font-size: 70px;
            color: black;
        }
        #btnK1 {
            position: relative;
            width: 100%;
            max-width: 600px;
            aspect-ratio: 2 / 1;
            margin: 20px auto;
            cursor: pointer;
            border: 5px solid black;
            border-radius: 20px;
            overflow: hidden;
            background-color: red;
            transition: background-color 0.5s;
            color: transparent;
            display: block;
        }
        #statusInfo {
            font-size: 48px;
            color: white;
            margin-top: 30px;
        }
    </style>
</head>
<body>
    <h1>Brama</h1>

    <button id="btnK1" onclick="activateRelay()"></button>
    <div style="position: absolute; top: 20px; right: 20px;">
        <a href="/logout" style="color: black; font-size: 20px; text-decoration: none;">Wyloguj</a>
    </div>
    <script>
        async function activateRelay() {
            const btn = document.getElementById("btnK1");

            btn.disabled = true;
            btn.style.pointerEvents = "none";
            btn.style.borderColor = "aqua";

            try {
                const response = await fetch("/click");
                if (!response.ok) {
                    const message = await response.text();
                    alert(message);
                }
            } catch (err) {
                console.error("Błąd aktywacji przekaźnika:", err);
                alert("Wystąpił błąd połączenia.");
            } finally {
                setTimeout(() => {
                    btn.style.borderColor = "black";
                }, 500);
                setTimeout(() => {
                    btn.disabled = false;
                    btn.style.pointerEvents = "auto";
                }, 1500);
            }
        }

        async function updateStatus() {
            try {
                const response = await fetch('/get_status');
                const state = await response.text();

                const btn = document.getElementById("btnK1");

                if (state === "open") {
                    btn.style.backgroundColor = "green";
                } else if (state === "closed") {
                    btn.style.backgroundColor = "red";
                } else if (state === "noconnect") {
                    btn.style.backgroundColor = "orange";
                }

            } catch (error) {
                console.error("Błąd pobierania stanu:", error);
            }
        }

        setInterval(updateStatus, 5000);
        updateStatus(); // od razu po załadowaniu
    </script>

</body>
</html>